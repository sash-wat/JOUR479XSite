`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
suppressMessages(library(tidyverse))
suppressMessages(library(nflreadr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(library(ggalt))
plays2022 <- load_pbp(
seasons = c(2010)
)
plays2022 <- plays2022 |> filter(play_type == "run" | play_type == "pass")
plays2022_3 <- plays2022 |> filter(week <= 3) |> filter(yardline_100 <= 20)
redzone2022_3 <- plays2022_3 |> group_by(posteam) |>
summarise(`RZ Plays Through W3` = n(),
`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
suppressMessages(library(tidyverse))
suppressMessages(library(nflreadr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(library(ggalt))
plays2022 <- load_pbp(
seasons = c(2022)
)
plays2022 <- plays2022 |> filter(play_type == "run" | play_type == "pass")
plays2022_3 <- plays2022 |> filter(week <= 3) |> filter(yardline_100 <= 20)
redzone2022_3 <- plays2022_3 |> group_by(posteam) |>
summarise(`RZ Plays Through W3` = n(),
`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
suppressMessages(library(tidyverse))
suppressMessages(library(nflreadr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(library(ggalt))
plays2022 <- load_pbp(
seasons = c(2005)
)
plays2022 <- plays2022 |> filter(play_type == "run" | play_type == "pass")
plays2022_3 <- plays2022 |> filter(week <= 3) |> filter(yardline_100 <= 20)
redzone2022_3 <- plays2022_3 |> group_by(posteam) |>
summarise(`RZ Plays Through W3` = n(),
`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
suppressMessages(library(tidyverse))
suppressMessages(library(nflreadr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(library(ggalt))
plays2022 <- load_pbp(
seasons = c(2022)
)
plays2022 <- plays2022 |> filter(play_type == "run" | play_type == "pass")
plays2022_3 <- plays2022 |> filter(week <= 3) |> filter(yardline_100 <= 20)
redzone2022_3 <- plays2022_3 |> group_by(posteam) |>
summarise(`RZ Plays Through W3` = n(),
`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
suppressMessages(library(tidyverse))
suppressMessages(library(nflreadr))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(library(ggalt))
plays2022 <- load_pbp(
seasons = c(2000)
)
plays2022 <- plays2022 |> filter(play_type == "run" | play_type == "pass")
plays2022_3 <- plays2022 |> filter(week <= 3) |> filter(yardline_100 <= 20)
redzone2022_3 <- plays2022_3 |> group_by(posteam) |>
summarise(`RZ Plays Through W3` = n(),
`Total EPA from RZ Plays Through W3` = sum(epa),
`EPA per RZ Play Through W3` = sum(epa)/n())
head(redzone2022_3 |> arrange(desc(`EPA per RZ Play Through W3`)))
plays2022_8 <- plays2022 |> filter(week <= 8) |> filter(yardline_100 <= 20)
redzone2022_8 <- plays2022_8 |> group_by(posteam) |>
summarise(`RZ Plays Through W8` = n(),
`Total EPA from RZ Plays Through W8` = sum(epa),
`EPA per RZ Play Through W8` = sum(epa)/n())
head(redzone2022_8 |> arrange(desc(`EPA per RZ Play Through W8`)))
combined <- merge(redzone2022_3, redzone2022_8 ,by="posteam")
combined <- combined |> mutate(`Change from W3 to W8` = `EPA per RZ Play Through W8` - `EPA per RZ Play Through W3`)
head(combined |> arrange(desc(`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
head(combined |> arrange((`Change from W3 to W8`)) |>
select(posteam, "EPA per RZ Play Through W3", "EPA per RZ Play Through W8", "Change from W3 to W8"))
increase <- combined |> filter(`EPA per RZ Play Through W3` < `EPA per RZ Play Through W8`)
decrease <- combined |> filter(`EPA per RZ Play Through W3` > `EPA per RZ Play Through W8`)
ggplot() +
geom_dumbbell(
data=increase,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Minnesota, NY Jets Amongst Biggest Increases in EPA per RZ Play", subtitle="18 of the NFL's teams saw an increase in EPA per RZ Play from 2022 Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh")
ggplot() +
geom_dumbbell(
data=decrease,
aes(y=reorder(posteam, `EPA per RZ Play Through W8`),
x= `EPA per RZ Play Through W3`, xend=`EPA per RZ Play Through W8`),
colour = "grey",
colour_x = "green",
colour_xend = "blue",
size=1
) +
xlab("Expected Points Added per RZ Play") +
ylab("Team") +
labs(title="Chicago, Detroit Amongst Biggest Decreases in EPA per RZ Play", subtitle="14 of the NFL's teams saw an decrease in EPA per RZ Play from Week 3 to Week 8",
caption="NFL Data | By: Sashwat Venkatesh") +
scale_color_manual(name = "", values = c("red", "blue") )
rm(list=ls())
install.packages("ggbump")
library(tidyverse)
library(cfbfastR)
plays_2023 <- cfbd_pbp_data(year=2023)
plays_2023 |> filter(drive_number ==1, play_number==1, play_type != "Kickoff") |> distinct(home, play_type)
logs <- read_csv("../data/footballlogs1122.csv")
logs <- logs |> mutate(
Differential = TeamScore - OpponentScore)
head(logs)
ols1 <- lm(Differential ~ Penalties, data=logs)
summary(ols1)
library(glmnet)
newlogs <- na.omit(logs)
y <- newlogs$Differential
z <- newlogs |> select_if(is.numeric)
x <- data.matrix(subset(z, select = -c(Differential, TeamScore, OpponentScore, Game, month, year)))
cv_model <- cv.glmnet(x, y, alpha = 1)
best_lambda <- cv_model$lambda.min
best_lambda
best_model <- glmnet(x, y, alpha = 1, lambda = best_lambda)
coef(best_model)
best_model
newlogs <- newlogs |> filter(abs(Differential) <= 7)
newlogs <- na.omit(newlogs)
y <- newlogs$Differential
z <- newlogs |> select_if(is.numeric)
x <- data.matrix(subset(z, select = -c(Differential, TeamScore, OpponentScore, Game, month, year)))
cv_model <- cv.glmnet(x, y, alpha = 1)
best_lambda <- cv_model$lambda.min
best_model <- glmnet(x, y, alpha = 1, lambda = best_lambda)
coef(best_model)
best_model
library(waffle)
md <- c("Rushing"=175, "Passing"=314)
ms <- c("Rushing"=100, "Passing"=221)
waffle(
md,
rows = 10,
title="Maryland's offense",
xlab="1 square = 1 yard",
colors = c("black", "red")
)
passing <- c("Maryland"=314, "Michigan State"=221)
waffle(
passing,
rows = 10,
title="Maryland vs Michigan State: passing",
xlab="1 square = 1 yard",
colors = c("red", "green")
)
iron(
waffle(md,
rows = 10,
title="Maryland's offense",
xlab="1 square = 1 yard",
colors = c("black", "red")
),
waffle(ms,
rows = 10,
title="Michigan State's offense",
xlab="1 square = 1 yard",
colors = c("black", "green")
)
)
md <- c("Rushing"=175, "Passing"=314)
ms <- c("Rushing"=100, "Passing"=221, 168)
iron(
waffle(md,
rows = 10,
title="Maryland's offense",
xlab="1 square = 1 yard",
colors = c("black", "red")
),
waffle(ms,
rows = 10,
title="Michigan State's offense",
xlab="1 square = 1 yard",
colors = c("black", "green", "white")
)
)
iron(
waffle(md/2,
rows = 10,
title="Maryland's offense",
xlab="1 square = 2 yard",
colors = c("black", "red")
),
waffle(ms/2,
rows = 10,
title="Michigan State's offense",
xlab="1 square = 2 yard",
colors = c("black", "green", "white")
)
)
library(ggbump)
rankings <- read_csv("https://thescoop.org/sports-data-files/cfbranking22.csv")
head(rankings)
ggplot() +
geom_bump(
data=rankings, aes(x=Week, y=Rank, color=Team))
top10 <- rankings |> filter(Week == 15 & Rank <= 10)
newrankings <- rankings |> filter(Team %in% top10$Team)
top10 <- rankings |> filter(Week == 15 & Rank <= 10)
newrankings <- rankings |> filter(Team %in% top10$Team)
ggplot() +
geom_bump(
data=newrankings, aes(x=Week, y=Rank, color=Team))
ggplot() +
geom_bump(
data=newrankings, aes(x=Week, y=Rank, color=Team)) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
scale_color_manual(values = c("#9E1B32","#F56600", "#BA0C2F", "#0021A5", "#ffcb05", "#BB0000", "#4d1979","#FF8200", "#990000", "#CC0000")) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
geom_text(data = newrankings |> filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +
geom_text(data = newrankings |> filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +
scale_color_manual(values = c("#9E1B32","#F56600", "#BA0C2F", "#0021A5", "#ffcb05", "#BB0000", "#4d1979","#FF8200", "#990000", "#CC0000")) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
geom_text(data = newrankings |> filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +
geom_text(data = newrankings |> filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +
labs(title="Last year's top ten was anything but boring", subtitle="", y= "Rank", x = "Week") +
theme_minimal() +
theme(
legend.position = "none",
panel.grid.major = element_blank()
) +
scale_color_manual(values = c("#9E1B32","#F56600", "#BA0C2F", "#0021A5", "#ffcb05", "#BB0000", "#4d1979","#FF8200", "#990000", "#CC0000")) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
geom_text(data = newrankings |> filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +
geom_text(data = newrankings |> filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +
labs(title="Last year's top ten was anything but boring", subtitle="", y= "Rank", x = "Week") +
theme_minimal() +
theme(
legend.position = "none",
panel.grid.major = element_blank(),
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
) +
scale_color_manual(values = c("#9E1B32","#F56600", "#BA0C2F", "#0021A5", "#ffcb05", "#BB0000", "#4d1979","#FF8200", "#990000", "#CC0000")) +
scale_y_reverse()
ggplot() +
geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) +
geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +
geom_text(data = newrankings |> filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +
geom_text(data = newrankings |> filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +
labs(title="Last year's top ten was anything but boring", subtitle="", y= "Rank", x = "Week") +
theme_minimal() +
theme(
legend.position = "none",
panel.grid.major = element_blank(),
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
) +
scale_color_manual(values = c("#9E1B32","#F56600", "#BA0C2F", "#0021A5", "#ffcb05", "#BB0000", "#4d1979","#FF8200", "#990000", "#CC0000")) +
scale_x_continuous(breaks=c(13,14,15,16,17)) +
scale_y_reverse(breaks=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))
