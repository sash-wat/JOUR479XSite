{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Clean Sheets") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Clean Sheets") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
suppressMessages(goalsGraphDef("Harry Maguire"))
suppressMessages(goalsGraphDef("Harry Maguire"))
suppressMessages(goalsGraphDef("Matthijs de Ligt"))
suppressMessages(goalsGraphDef("Lucas Hernández"))
goalsGraphGK <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Clean Sheets") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Clean Sheets") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
suppressMessages(goalsGraphDef("Kepa Arrizabalaga"))
suppressMessages(goalsGraphDef("Alisson"))
suppressMessages(goalsGraphDef("Alisson"))
suppressMessages(head(player_stats("Lionel Messi", "all")))
valueGraph <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_line(data=df, aes(x=season , y=value), color="red") +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp
}
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur))
}
valueGraph("Lionel Messi")
valueGraph("Cristiano Ronaldo")
valueGraph("Lionel Messi")
valueGraph("Kylian Mbappé")
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur)) +
labs(title=paste(player, "Market Value by Season") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")
}
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur)) +
ylab("Market Value, Euros") +
xlabl("Season")
labs(title=paste(player, "Market Value by Season") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")
}
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur)) +
ylab("Market Value, Euros") +
xlabl("Season") +
labs(title=paste(player, "Market Value by Season") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")
}
valueGraph("Lionel Messi")
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur)) +
ylab("Market Value, Euros") +
xlab("Season") +
labs(title=paste(player, "Market Value by Season") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")
}
valueGraph("Lionel Messi")
suppressMessages(goalsGraph("Neymar"))
valueGraph("Neymar")
suppressMessages(goalsGraph("Neymar"))
suppressMessages(valueGraph("Neymar"))
suppressMessages(library(tidyverse))
suppressMessages(library(lubridate))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(clubs <- read_csv("~/Desktop/TransferMarkt Data/clubs.csv"))
suppressMessages(players <- read_csv("~/Desktop/TransferMarkt Data/players.csv"))
suppressMessages(player_valuations<- read_csv("~/Desktop/TransferMarkt Data/player_valuations.csv"))
suppressMessages(games <- read_csv("~/Desktop/TransferMarkt Data/games.csv"))
suppressMessages(game_events <- read_csv("~/Desktop/TransferMarkt Data/game_events.csv"))
suppressMessages(comps <- read_csv("~/Desktop/TransferMarkt Data/competitions.csv"))
suppressMessages(club_games <- read_csv("~/Desktop/TransferMarkt Data/club_games.csv"))
suppressMessages(appearances <- read_csv("~/Desktop/TransferMarkt Data/appearances.csv"))
player_stats <-function(name, year) {
df <- merge(appearances, games, by="game_id", all.x=TRUE)
df$goals_for <- ifelse(df$home_club_id == df$player_club_id, df$home_club_goals,
ifelse(df$away_club_id == df$player_club_id, df$away_club_goals, NA))
df$goals_against <- ifelse(df$home_club_id == df$player_club_id, df$away_club_goals,
ifelse(df$away_club_id == df$player_club_id, df$home_club_goals, NA))
df$clean_sheet <- ifelse(df$goals_against == 0, 1,
ifelse(df$goals_against > 0, 0, NA))
if (year == "all") {
df <- df |> group_by(player_id, player_name, season) |>
summarise(
g = sum(goals),
a = sum(assists),
cs = sum(clean_sheet),
yc = sum(yellow_cards),
rc = sum(red_cards),
app = n()
) |> filter(player_name == name)
}
else {
df <- df |> group_by(player_id, player_name, season) |>
summarise(
g = sum(goals),
a = sum(assists),
cs = sum(clean_sheet),
app = n()
) |> filter(player_name == name) |> filter(season == year)
}
df
}
suppressMessages(head(player_stats("Lionel Messi", "all")))
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
valueGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data=temp, aes(x=year, y=market_value_in_eur)) +
ylab("Market Value, Euros") +
xlab("Season") +
labs(title=paste(player, "Market Value by Season") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")
}
suppressMessages(goalsGraph("Lionel Messi"))
suppressMessages(valueGraph("Lionel Messi"))
suppressMessages(goalsGraph("Neymar"))
suppressMessages(valueGraph("Neymar"))
suppressMessages(goalsGraph("Kylian Mbappé"))
suppressMessages(valueGraph("Kylian Mbappé"))
suppressMessages(goalsGraph("Antoine Griezmann"))
suppressMessages(valueGraph("Antoine Griezmann"))
goalsGraphGA <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"] + temp2[row1, "a"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("G+A") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. G+A") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
suppressMessages(goalsGraphGA("Philippe Coutinho"))
suppressMessages(valueGraph("Philippe Coutinho"))
suppressMessages(goalsGraphGA("Jack Grealish"))
suppressMessages(valueGraph("Jack Grealish"))
suppressMessages(goalsGraphGA("Declan Rice"))
suppressMessages(valueGraph("Declan Rice"))
goalsGraphDef <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Clean Sheets") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Clean Sheets") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
suppressMessages(goalsGraphDef("Harry Maguire"))
suppressMessages(valueGraph("Harry Maguire"))
suppressMessages(goalsGraphDef("Harry Maguire"))
suppressMessages(valueGraph("Harry Maguire"))
suppressMessages(goalsGraphDef("Matthijs de Ligt"))
suppressMessages(valueGraph("Matthijs de Ligt"))
suppressMessages(goalsGraphDef("Lucas Hernández"))
suppressMessages(valueGraph("Lucas Hernández"))
goalsGraphGK <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Clean Sheets") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Clean Sheets") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
suppressMessages(goalsGraphGK("Kepa Arrizabalaga"))
suppressMessages(valueGraph("Kepa Arrizabalaga"))
suppressMessages(goalsGraphGK("Alisson"))
suppressMessages(valueGraph("Alisson"))
suppressMessages(goalsGraphGK("André Onana"))
suppressMessages(valueGraph("André Onana"))
suppressMessages(goalsGraph("Lionel Messi"))
suppressMessages(valueGraph("Lionel Messi"))
