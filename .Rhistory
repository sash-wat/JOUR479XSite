arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur), color="red")
cr7 <- player_stats('Cristiano Ronaldo', "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(cr7)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == cr7[row1, "season"] + 1) {
t <- append(t, cr7[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
#fit <- lm(value ~ goals, data = df)
#summary(fit)
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
goalsGraph <- function(player, player_id) {
temp <- player_valuations |>
filter(player_id == player_id) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo", 8198)
View(temp)
goalsGraph <- function(player, player_id) {
temp <- player_valuations |>
filter(player_id == player_id) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp
}
goalsGraph("Cristiano Ronaldo", 8198)
goalsGraph <- function(player, player_id_input) {
temp <- player_valuations |>
filter(player_id == player_id_input) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp
}
goalsGraph("Cristiano Ronaldo", 8198)
goalsGraph <- function(player, player_id_input) {
temp <- player_valuations |>
filter(player_id == player_id_input) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo", 8198)
View(players)
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow
}
goalsGraph <- function(player, player_id_input) {
temp <- player_valuations |>
filter(player_id == player_id_input) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
get_pid("Cristiano Ronaldo")
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
goalsGraph <- function(player, player_id_input) {
temp <- player_valuations |>
filter(player_id == player_id_input) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
get_pid("Cristiano Ronaldo")
goalsGraph("Cristiano Ronaldo", get_pid("Cristiano Ronaldo"))
goalsGraph("Cristiano Ronaldo")
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
get_pid("Cristiano Ronaldo")
goalsGraph("Cristiano Ronaldo")
head(player_stats("Lionel Messi", "all"))
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == 8198) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title="Cristiano Ronaldo, Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=player+", Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, ", Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
head(player_stats("Lionel Messi", "all"))
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
goalsGraph("Lionel Messi")
View(players)
goalsGraph("Lionel Messi")
View(players)
View(player_valuations)
View(clubs)
goalsGraph("Lionel Messi")
head(players |> filter(current_club_domestic_competition_id == "GB1"))
head(players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1"))
head(players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1")) |>
filter(position == "Midfield")
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "ES1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
for (row in 1:nrow(gbmids)) {
goalsGraph(gbmids[row, name])
}
View(games)
View(gbmids)
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
for (row in 1:nrow(gbmids)) {
goalsGraph(gbmids[row, "name"])
}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[0]
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
for (player in gbmids$name) {
print(player)
}
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
for (player in gbmids$name) {
goalsGraph(player)
}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids$name[1]
for (player in gbmids$name) {
goalsGraph(player)
}
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
