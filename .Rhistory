for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=player+", Market Value vs. Goals Scored" , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, ", Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
head(player_stats("Lionel Messi", "all"))
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
}
goalsGraph("Cristiano Ronaldo")
goalsGraph("Lionel Messi")
View(players)
goalsGraph("Lionel Messi")
View(players)
View(player_valuations)
View(clubs)
goalsGraph("Lionel Messi")
head(players |> filter(current_club_domestic_competition_id == "GB1"))
head(players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1"))
head(players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1")) |>
filter(position == "Midfield")
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "ES1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids
for (row in 1:nrow(gbmids)) {
goalsGraph(gbmids[row, name])
}
View(games)
View(gbmids)
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
for (row in 1:nrow(gbmids)) {
goalsGraph(gbmids[row, "name"])
}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[0]
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
for (player in gbmids$name) {
print(player)
}
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield")
gbmids$name[1]
for (player in gbmids$name) {
goalsGraph(player)
}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids$name[1]
for (player in gbmids$name) {
goalsGraph(player)
}
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
suppressMessages(library(tidyverse))
suppressMessages(library(lubridate))
suppressMessages(library(ggplot2))
suppressMessages(library(ggrepel))
suppressMessages(clubs <- read_csv("~/Desktop/TransferMarkt Data/clubs.csv"))
suppressMessages(players <- read_csv("~/Desktop/TransferMarkt Data/players.csv"))
suppressMessages(player_valuations<- read_csv("~/Desktop/TransferMarkt Data/player_valuations.csv"))
suppressMessages(games <- read_csv("~/Desktop/TransferMarkt Data/games.csv"))
suppressMessages(game_events <- read_csv("~/Desktop/TransferMarkt Data/game_events.csv"))
suppressMessages(comps <- read_csv("~/Desktop/TransferMarkt Data/competitions.csv"))
suppressMessages(club_games <- read_csv("~/Desktop/TransferMarkt Data/club_games.csv"))
suppressMessages(appearances <- read_csv("~/Desktop/TransferMarkt Data/appearances.csv"))
player_stats <-function(name, year) {
df <- merge(appearances, games, by="game_id", all.x=TRUE)
df$goals_for <- ifelse(df$home_club_id == df$player_club_id, df$home_club_goals,
ifelse(df$away_club_id == df$player_club_id, df$away_club_goals, NA))
df$goals_against <- ifelse(df$home_club_id == df$player_club_id, df$away_club_goals,
ifelse(df$away_club_id == df$player_club_id, df$home_club_goals, NA))
df$clean_sheet <- ifelse(df$goals_against == 0, 1,
ifelse(df$goals_against > 0, 0, NA))
if (year == "all") {
df <- df |> group_by(player_id, player_name, season) |>
summarise(
g = sum(goals),
a = sum(assists),
cs = sum(clean_sheet),
) |> filter(player_name == name)
}
else {
df <- df |> group_by(player_id, player_name, season) |>
summarise(
g = sum(goals),
a = sum(assists),
cs = sum(clean_sheet),
app = n()
) |> filter(player_name == name) |> filter(season == year)
}
df
}
head(player_stats("Lionel Messi", "all"))
get_pid <- function(player) {
pRow <- players |> filter(name == player)
pRow$player_id
}
valuation_history <- function(player) {
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
ggplot() +
geom_line(data = temp, aes(x=temp$date, y=temp$market_value_in_eur))
}
goalsGraph <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Goals Scored") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
goalsGraph("Lionel Messi")
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
for (player in gbmids$name) {
goalsGraph(player)
}
#for (row in 1:nrow(gbmids)) {
# goalsGraph(gbmids[row, "name"])
#}
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids
goalsGraph("Lucas Paquetá")
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids
goalsGraph("Erling Haaland")
gbmids <- players |> filter(last_season > 2022) |> filter(current_club_domestic_competition_id == "GB1") |>
filter(position == "Midfield") |> filter(market_value_in_eur > 25000000)
gbmids
goalsGraph("Karim Benzema")
View(players)
goalsGraph("Neymar")
goalsGraph("Lionel Messi")
goalsGraph("Kylian Mbappé")
goalsGraph("João Félix")
goalsGraphGA <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"] + temp2[row1, "a"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Goals") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. G+A") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
View(players)
goalsGraphGA("Philippe Coutinho")
goalsGraphGA <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "g"] + temp2[row1, "a"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("G+A") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. G+A") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
goalsGraphGA("Philippe Coutinho")
goalsGraphGA("Enzo Fernández")
goalsGraphGA("Jack Grealish")
goalsGraphGA("Declan Rice")
goalsGraphGA("Josko Gvardiol")
goalsGraphDef <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("G+A") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. G+A") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
goalsGraphDef("Josko Gvardiol")
goalsGraphDef <- function(player) {
tryCatch(
{
temp <- player_valuations |>
filter(player_id == get_pid(player)) |> filter(format(date, "%m") == "05" | format(date, "%m") == "06" | format(date, "%m") == "07" | format(date, "%m") == "08") |>
arrange(date)
temp <- temp |>
mutate(year = lubridate::year(date)) |>  # Create a new column with the year
group_by(year) |>
filter(date == max(date)) |>
select(-year)
temp2 <- player_stats(player, "all")
t <- list()
u <- list()
v <- list()
for (row1 in 1:nrow(temp2)) {
for (row2 in 1:nrow(temp)) {
if (temp[row2, "year"] == temp2[row1, "season"] + 1) {
t <- append(t, temp2[row1, "cs"])
u <- append(u, temp[row2, "market_value_in_eur"])
v <- append(v, temp[row2, "year"])
}
}
}
df <- data.frame(goals = unlist(t), value=unlist(u), season=unlist(v))
ggplot() +
geom_point(data=df, aes(x=goals, y=value), color="red") +
geom_smooth(data=df, aes(x=goals, y=value), method="lm") +
geom_text_repel(data=df, aes(x=goals, y=value), label=df$season) +
xlab("Clean Sheets") +
ylab("Market Value, Euros") +
labs(title=paste(player, "Market Value vs. Clean Sheets") , caption="Source: TransferMarkt Data 2011-2023 | By Sashwat Venkatesh")  + theme_minimal()
},
error=function(e) {
message('An Error Occurred')
print(e)
},
warning=function(w) {
message('A Warning Occurred')
print(w)
return(NA)
}
)
}
goalsGraphDef("Harry Maguire")
goalsGraphDef("Virgil Van Dijk")
goalsGraphDef("Virgil van Dijk")
goalsGraphDef("Wesley Fofana")
goalsGraphDef("Kepa Arrizabalaga")
goalsGraphDef("Alisson")
goalsGraphDef("André Onana")
goalsGraphDef("Lucas Hernández")
