group_by(year) |>
summarise(all_games = n())
thirtyfive_plus <- wv_games |>
filter(differential >= 35) |>
group_by(year) |>
summarise(thirtyfive_plus_games = n())
thirtyfive_with_pct <- all_games |>
inner_join(thirtyfive_plus) |>
mutate(pct = thirtyfive_plus_games/all_games *100) |>
arrange(desc(pct))
all_games |>
inner_join(thirtyfive_plus) |>
mutate(pct = thirtyfive_plus_games/all_games *100) |>
arrange(desc(pct))
ggplot() +
geom_bar(data=thirtyfive_with_pct, aes(x=year, weight=pct)) +
labs(
title="West Virginia High School Football's Lopsided Games",
subtitle = "More than 45 percent of games this season have a margin of 35 or more points, a modern high.",
x="Year",
y="Percent"
) + theme_minimal()
home_margins <- wv_games |>
mutate(home_team_margin = home_team_score - visiting_team_score) |>
group_by(year, home_team) |>
summarize(home_games = n(), home_margin = sum(home_team_margin))
visiting_margins <- wv_games |>
mutate(visiting_team_margin = visiting_team_score - home_team_score) |>
group_by(year, visiting_team) |>
summarize(visiting_games = n(), visiting_margin = sum(visiting_team_margin))
team_margins <- home_margins |> left_join(visiting_margins, join_by(home_team == visiting_team, year == year)) |>
mutate(home_games = replace_na(home_games, 0)) |>
mutate(visiting_games = replace_na(visiting_games, 0)) |>
mutate(home_margin = replace_na(home_margin, 0)) |>
mutate(visiting_margin = replace_na(visiting_margin, 0)) |>
mutate(total_games = home_games + visiting_games, total_margin = home_margin + visiting_margin) |>
rename(team = home_team) |>
group_by(team, year) |>
summarize(avg_margin = total_margin/total_games) |>
arrange(desc(avg_margin))
top10 <- team_margins |> ungroup() |>  top_n(10, wt=avg_margin) |> mutate(display = paste(team, year))
bottom10 <- team_margins |> ungroup() |> top_n(10, wt=-avg_margin)|> mutate(display = paste(team, year))
bar1 <- ggplot() +
geom_bar(data=top10, aes(x=reorder(display, avg_margin), weight=avg_margin)) +
coord_flip() +
labs(title="WV's Most Dominant and Dominated Teams", subtitle = "This season has seen some historically lopsided results.",  x="", y="Average margin in points", caption = "") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
)
bar2 <- ggplot() +
geom_bar(data=bottom10, aes(x=reorder(display, avg_margin), weight=avg_margin)) +
coord_flip() +
labs(title = "", subtitle= "", x="", y="",  caption="Source: WV Tailgate Central | By Derek Willis") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
)
plot_grid(bar1, bar2)
wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
library(tidyverse)
library(ggplot2)
graph <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_bar(data=graph, aes(x=year, y = avg_diff))
wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
) |>
ggplot() +
geom_bar(aes(x=year, y = avg_diff))
View(graph)
graph <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
df <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_point(data=df, aes(x=year, y=avg_diff))
df <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_bar(data=df, aes(x=year, y=avg_diff))
df <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_bar(data=df, aes(y=avg_diff))
df <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_bar(data=df, aes(x=year))
df <- wv_games |> group_by(year) |> summarize(
games = n(),
total_diff = sum(differential),
avg_diff = mean(differential)
)
ggplot() +
geom_bar(data=df, aes(x=year, weight=avg_diff))
ggplot() +
geom_bar(data=thirtyfive_with_pct, aes(x=year, weight=pct)) +
labs(
title="West Virginia High School Football's Lopsided Games",
subtitle = "More than 45 percent of games this season have a margin of 35 or more points, a modern high.",
x="Year",
y="Percent"
) + theme_minimal()
home_margins <- wv_games |>
mutate(home_team_margin = home_team_score - visiting_team_score) |>
group_by(year, home_team) |>
summarize(home_games = n(), home_margin = sum(home_team_margin))
visiting_margins <- wv_games |>
mutate(visiting_team_margin = visiting_team_score - home_team_score) |>
group_by(year, visiting_team) |>
summarize(visiting_games = n(), visiting_margin = sum(visiting_team_margin))
team_margins <- home_margins |> left_join(visiting_margins, join_by(home_team == visiting_team, year == year)) |>
mutate(home_games = replace_na(home_games, 0)) |>
mutate(visiting_games = replace_na(visiting_games, 0)) |>
mutate(home_margin = replace_na(home_margin, 0)) |>
mutate(visiting_margin = replace_na(visiting_margin, 0)) |>
mutate(total_games = home_games + visiting_games, total_margin = home_margin + visiting_margin) |>
rename(team = home_team) |>
group_by(team, year) |>
summarize(avg_margin = total_margin/total_games) |>
arrange(desc(avg_margin))
home_margins <- wv_games |>
mutate(home_team_margin = home_team_score - visiting_team_score) |>
group_by(year, home_team) |>
summarize(home_games = n(), home_margin = sum(home_team_margin))
visiting_margins <- wv_games |>
mutate(visiting_team_margin = visiting_team_score - home_team_score) |>
group_by(year, visiting_team) |>
summarize(visiting_games = n(), visiting_margin = sum(visiting_team_margin))
team_margins <- home_margins |> left_join(visiting_margins, join_by(home_team == visiting_team, year == year)) |>
mutate(home_games = replace_na(home_games, 0)) |>
mutate(visiting_games = replace_na(visiting_games, 0)) |>
mutate(home_margin = replace_na(home_margin, 0)) |>
mutate(visiting_margin = replace_na(visiting_margin, 0)) |>
mutate(total_games = home_games + visiting_games, total_margin = home_margin + visiting_margin) |>
rename(team = home_team) |>
group_by(team, year) |>
summarize(avg_margin = total_margin/total_games) |>
arrange(desc(avg_margin))
View(team_margins)
install.packages("cowplot")
library(tidyverse)
library(ggplot2)
library(cowplot)
top10 <- team_margins |> ungroup() |>  top_n(10, wt=avg_margin) |> mutate(display = paste(team, year))
bottom10 <- team_margins |> ungroup() |> top_n(10, wt=-avg_margin)|> mutate(display = paste(team, year))
bar1 <- ggplot() +
geom_bar(data=top10, aes(x=reorder(display, avg_margin), weight=avg_margin)) +
coord_flip() +
labs(title="WV's Most Dominant and Dominated Teams", subtitle = "This season has seen some historically lopsided results.",  x="", y="Average margin in points", caption = "") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
)
bar2 <- ggplot() +
geom_bar(data=bottom10, aes(x=reorder(display, avg_margin), weight=avg_margin)) +
coord_flip() +
labs(title = "", subtitle= "", x="", y="",  caption="Source: WV Tailgate Central | By Derek Willis") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
axis.title = element_text(size = 8),
plot.subtitle = element_text(size=10),
panel.grid.minor = element_blank()
)
plot_grid(bar1, bar2)
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
rm(list=ls())
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
View(bigdf)
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(date < "2022-07-01")
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(Date < "2022-07-01")
View(sh)
View(sh)
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(Date < "2022-07-01")
md <- bigdf |> filter(TeamFull == "Maryland Terrapins") |> filter(Date > "2022-07-02")
View(md)
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv")
sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(Date < "2022-07-01")
md <- bigdf |> filter(TeamFull == "Maryland Terrapins") |> filter(Date > "2022-07-02")
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
suppressMessages(bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv"))
suppressMessages(sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(Date < "2022-07-01"))
suppressMessages(md <- bigdf |> filter(TeamFull == "Maryland Terrapins") |> filter(Date > "2022-07-02"))
sh |> summarise(
ppg = mean(TeamScore)
)
sh |> summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore)
)
sh |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore)
)
sh |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA)
)
suppressMessages(library(tidyverse))
suppressMessages(library(ggplot2))
suppressMessages(library(formattable))
suppressMessages(bigdf <- read_csv("https://thescoop.org/sports-data-files/cbblogs1524.csv"))
suppressMessages(sh <- bigdf |> filter(TeamFull == "Seton Hall Pirates") |> filter(Date < "2022-07-01"))
suppressMessages(md2 <- bigdf |> filter(TeamFull == "Maryland Terrapins") |> filter(Date > "2022-07-02"))
suppressMessages(md1 <- bigdf |> filter(TeamFull == "Maryland Terrapins") |> filter(Date < "2022-07-02"))
md1 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA)
)
md1 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md1 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md1 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
tfg = mean(Team3P),
tfgag = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
three/g = mean(Team3P),
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md1 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks)
)
md1 |> group_by(Season) |> summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
fls = mean(TeamPersonalFouls)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
fls = mean(TeamPersonalFouls)
)
md1 |> group_by(Season) |> summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
fls = mean(OpponentPersonalFouls)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
fls = mean(OpponentPersonalFouls)
)
md1 |> group_by(Season) |> summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers)
)
md2 |> group_by(Season) |>summarise(
ppg = mean(TeamScore),
oppg = mean(OpponentScore),
fgg = mean(TeamFG),
fgag = mean(TeamFGA),
`three/g` = mean(Team3P),
`threeA/g` = mean(Team3PA),
fgpctg = fgg/fgag,
trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
stlg = mean(TeamSteals),
blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers)
)
md2 |> group_by(Season) |>summarise(
#ppg = mean(TeamScore),
oppg = mean(OpponentScore),
#fgg = mean(TeamFG),
#fgag = mean(TeamFGA),
#`three/g` = mean(Team3P),
#`threeA/g` = mean(Team3PA),
#fgpctg = fgg/fgag,
#trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
#stlg = mean(TeamSteals),
#blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers)
)
md2 |> group_by(Season) |>summarise(
#ppg = mean(TeamScore),
oppg = mean(OpponentScore),
#fgg = mean(TeamFG),
#fgag = mean(TeamFGA),
#`three/g` = mean(Team3P),
#`threeA/g` = mean(Team3PA),
#fgpctg = fgg/fgag,
#trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
#stlg = mean(TeamSteals),
#blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers),
oppFTA = mean(OpponentFTA)
)
md1 |> group_by(Season) |>summarise(
#ppg = mean(TeamScore),
oppg = mean(OpponentScore),
#fgg = mean(TeamFG),
#fgag = mean(TeamFGA),
#`three/g` = mean(Team3P),
#`threeA/g` = mean(Team3PA),
#fgpctg = fgg/fgag,
#trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
#stlg = mean(TeamSteals),
#blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers),
oppFTA = mean(OpponentFTA)
)
md1 |> group_by(Season) |>summarise(
#ppg = mean(TeamScore),
oppg = mean(OpponentScore),
#fgg = mean(TeamFG),
#fgag = mean(TeamFGA),
#`three/g` = mean(Team3P),
#`threeA/g` = mean(Team3PA),
#fgpctg = fgg/fgag,
#trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
#stlg = mean(TeamSteals),
#blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers),
fta = mean(TeamFTA),
oppFTA = mean(OpponentFTA)
)
md2 |> group_by(Season) |>summarise(
#ppg = mean(TeamScore),
oppg = mean(OpponentScore),
#fgg = mean(TeamFG),
#fgag = mean(TeamFGA),
#`three/g` = mean(Team3P),
#`threeA/g` = mean(Team3PA),
#fgpctg = fgg/fgag,
#trbsg = mean(TeamTotalRebounds - TeamOffRebounds),
#stlg = mean(TeamSteals),
#blkg = mean(TeamBlocks),
tov = mean(OpponentTurnovers),
fta = mean(TeamFTA),
oppFTA = mean(OpponentFTA)
)
